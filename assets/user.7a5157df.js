import{a0 as q,a1 as G,a2 as Q,C as R,a3 as X,w as T,a4 as Y,n as Z,a5 as ee,a6 as h}from"./index.0ee44323.js";import{api as A}from"./axios.6091280a.js";function re(e){return G()?(Q(e),!0):!1}function j(e){return typeof e=="function"?e():q(e)}const $=typeof window!="undefined",te=()=>{};function ne(e,t){function r(...n){return new Promise((o,s)=>{Promise.resolve(e(()=>t.apply(this,n),{fn:t,thisArg:this,args:n})).then(o).catch(s)})}return r}const k=e=>e();function ae(e=k){const t=R(!0);function r(){t.value=!1}function n(){t.value=!0}const o=(...s)=>{t.value&&e(...s)};return{isActive:X(t),pause:r,resume:n,eventFilter:o}}var D=Object.getOwnPropertySymbols,oe=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable,ie=(e,t)=>{var r={};for(var n in e)oe.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&D)for(var n of D(e))t.indexOf(n)<0&&se.call(e,n)&&(r[n]=e[n]);return r};function le(e,t,r={}){const n=r,{eventFilter:o=k}=n,s=ie(n,["eventFilter"]);return T(e,ne(o,t),s)}var ce=Object.defineProperty,ue=Object.defineProperties,fe=Object.getOwnPropertyDescriptors,b=Object.getOwnPropertySymbols,x=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable,J=(e,t,r)=>t in e?ce(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,pe=(e,t)=>{for(var r in t||(t={}))x.call(t,r)&&J(e,r,t[r]);if(b)for(var r of b(t))U.call(t,r)&&J(e,r,t[r]);return e},de=(e,t)=>ue(e,fe(t)),ye=(e,t)=>{var r={};for(var n in e)x.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&b)for(var n of b(e))t.indexOf(n)<0&&U.call(e,n)&&(r[n]=e[n]);return r};function ge(e,t,r={}){const n=r,{eventFilter:o}=n,s=ye(n,["eventFilter"]),{eventFilter:y,pause:w,resume:v,isActive:u}=ae(o);return{stop:le(e,t,de(pe({},s),{eventFilter:y})),pause:w,resume:v,isActive:u}}function _e(e){var t;const r=j(e);return(t=r==null?void 0:r.$el)!=null?t:r}const P=$?window:void 0;$&&window.document;$&&window.navigator;$&&window.location;function C(...e){let t,r,n,o;if(typeof e[0]=="string"||Array.isArray(e[0])?([r,n,o]=e,t=P):[t,r,n,o]=e,!t)return te;Array.isArray(r)||(r=[r]),Array.isArray(n)||(n=[n]);const s=[],y=()=>{s.forEach(l=>l()),s.length=0},w=(l,c,g,f)=>(l.addEventListener(c,g,f),()=>l.removeEventListener(c,g,f)),v=T(()=>[_e(t),j(o)],([l,c])=>{y(),l&&s.push(...r.flatMap(g=>n.map(f=>w(l,g,f,c))))},{immediate:!0,flush:"post"}),u=()=>{v(),y()};return re(u),u}const O=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},S="__vueuse_ssr_handlers__",we=ve();function ve(){return S in O||(O[S]=O[S]||{}),O[S]}function me(e,t){return we[e]||t}function he(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}var Oe=Object.defineProperty,I=Object.getOwnPropertySymbols,Se=Object.prototype.hasOwnProperty,be=Object.prototype.propertyIsEnumerable,V=(e,t,r)=>t in e?Oe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,z=(e,t)=>{for(var r in t||(t={}))Se.call(t,r)&&V(e,r,t[r]);if(I)for(var r of I(t))be.call(t,r)&&V(e,r,t[r]);return e};const Pe={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},L="vueuse-storage";function $e(e,t,r,n={}){var o;const{flush:s="pre",deep:y=!0,listenToStorageChanges:w=!0,writeDefaults:v=!0,mergeDefaults:u=!1,shallow:l,window:c=P,eventFilter:g,onError:f=a=>{console.error(a)}}=n,_=(l?Y:R)(t);if(!r)try{r=me("getDefaultStorage",()=>{var a;return(a=P)==null?void 0:a.localStorage})()}catch(a){f(a)}if(!r)return _;const p=j(t),N=he(p),m=(o=n.serializer)!=null?o:Pe[N],{pause:M,resume:F}=ge(_,()=>H(_.value),{flush:s,deep:y,eventFilter:g});return c&&w&&(C(c,"storage",E),C(c,L,K)),E(),_;function H(a){try{if(a==null)r.removeItem(e);else{const i=m.write(a),d=r.getItem(e);d!==i&&(r.setItem(e,i),c&&c.dispatchEvent(new CustomEvent(L,{detail:{key:e,oldValue:d,newValue:i,storageArea:r}})))}}catch(i){f(i)}}function B(a){const i=a?a.newValue:r.getItem(e);if(i==null)return v&&p!==null&&r.setItem(e,m.write(p)),p;if(!a&&u){const d=m.read(i);return typeof u=="function"?u(d,p):N==="object"&&!Array.isArray(d)?z(z({},p),d):d}else return typeof i!="string"?i:m.read(i)}function K(a){E(a.detail)}function E(a){if(!(a&&a.storageArea!==r)){if(a&&a.key==null){_.value=p;return}if(!(a&&a.key!==e)){M();try{_.value=B(a)}catch(i){f(i)}finally{a?Z(F):F()}}}}}function W(e,t,r={}){const{window:n=P}=r;return $e(e,t,n==null?void 0:n.localStorage,r)}const je=ee("user",{state:()=>({user:{},access_token:W("access_token",""),refresh_token:W("refresh_token","")}),getters:{isLoggedIn:e=>e.access_token.length>0},actions:{async registerUser(e,t,r){try{const n=await A.post("/register",{username:e,email:t,password:r});return h.create({message:"Registration is successfully complete.",icon:"check_circle",color:"green"}),n.data}catch(n){h.create({message:`Error: ${JSON.stringify(Object.values(n.response.data)[0][0])}`,icon:"error",color:"red"})}},async loginUser(e,t){try{const r=await A.post("/login/",{username:e,password:t});return h.create({message:"Logged in!",icon:"check_circle",color:"green"}),this.access_token=r.data.access,this.refresh_token=r.data.refresh,this.access_token}catch(r){h.create({message:`Error: ${JSON.stringify(r.response.data)}`,icon:"error",color:"red"});return}},async fetchCurrentUser(){const e={Authorization:`Bearer ${this.access_token}`};try{const t=await A.get("/user",{headers:e});return this.user=t.data,this.user}catch{return}}}});export{je as u};
