import{a9 as q,aa as G,ab as Q,y as C,ac as X,B as L,ad as Y,D as Z,ae as ee,af as O}from"./index.c8a8fcf2.js";import{api as _}from"./axios.d363f6e4.js";function re(e){return G()?(Q(e),!0):!1}function j(e){return typeof e=="function"?e():q(e)}const E=typeof window!="undefined",te=()=>{};function ne(e,r){function t(...n){return new Promise((a,o)=>{Promise.resolve(e(()=>r.apply(this,n),{fn:r,thisArg:this,args:n})).then(a).catch(o)})}return t}const W=e=>e();function se(e=W){const r=C(!0);function t(){r.value=!1}function n(){r.value=!0}const a=(...o)=>{r.value&&e(...o)};return{isActive:X(r),pause:t,resume:n,eventFilter:a}}var D=Object.getOwnPropertySymbols,ae=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable,ie=(e,r)=>{var t={};for(var n in e)ae.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&D)for(var n of D(e))r.indexOf(n)<0&&oe.call(e,n)&&(t[n]=e[n]);return t};function ce(e,r,t={}){const n=t,{eventFilter:a=W}=n,o=ie(n,["eventFilter"]);return L(e,ne(a,r),o)}var le=Object.defineProperty,ue=Object.defineProperties,fe=Object.getOwnPropertyDescriptors,$=Object.getOwnPropertySymbols,B=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable,z=(e,r,t)=>r in e?le(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,pe=(e,r)=>{for(var t in r||(r={}))B.call(r,t)&&z(e,t,r[t]);if($)for(var t of $(r))R.call(r,t)&&z(e,t,r[t]);return e},de=(e,r)=>ue(e,fe(r)),he=(e,r)=>{var t={};for(var n in e)B.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&$)for(var n of $(e))r.indexOf(n)<0&&R.call(e,n)&&(t[n]=e[n]);return t};function ye(e,r,t={}){const n=t,{eventFilter:a}=n,o=he(n,["eventFilter"]),{eventFilter:h,pause:g,resume:w,isActive:u}=se(a);return{stop:ce(e,r,de(pe({},o),{eventFilter:h})),pause:g,resume:w,isActive:u}}function ve(e){var r;const t=j(e);return(r=t==null?void 0:t.$el)!=null?r:t}const P=E?window:void 0;E&&window.document;E&&window.navigator;E&&window.location;function J(...e){let r,t,n,a;if(typeof e[0]=="string"||Array.isArray(e[0])?([t,n,a]=e,r=P):[r,t,n,a]=e,!r)return te;Array.isArray(t)||(t=[t]),Array.isArray(n)||(n=[n]);const o=[],h=()=>{o.forEach(c=>c()),o.length=0},g=(c,l,y,f)=>(c.addEventListener(l,y,f),()=>c.removeEventListener(l,y,f)),w=L(()=>[ve(r),j(a)],([c,l])=>{h(),c&&o.push(...t.flatMap(y=>n.map(f=>g(c,y,f,l))))},{immediate:!0,flush:"post"}),u=()=>{w(),h()};return re(u),u}const S=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},b="__vueuse_ssr_handlers__",_e=ge();function ge(){return b in S||(S[b]=S[b]||{}),S[b]}function we(e,r){return _e[e]||r}function me(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}var Oe=Object.defineProperty,U=Object.getOwnPropertySymbols,Se=Object.prototype.hasOwnProperty,be=Object.prototype.propertyIsEnumerable,k=(e,r,t)=>r in e?Oe(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,x=(e,r)=>{for(var t in r||(r={}))Se.call(r,t)&&k(e,t,r[t]);if(U)for(var t of U(r))be.call(r,t)&&k(e,t,r[t]);return e};const $e={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},I="vueuse-storage";function Pe(e,r,t,n={}){var a;const{flush:o="pre",deep:h=!0,listenToStorageChanges:g=!0,writeDefaults:w=!0,mergeDefaults:u=!1,shallow:c,window:l=P,eventFilter:y,onError:f=s=>{console.error(s)}}=n,v=(c?Y:C)(r);if(!t)try{t=we("getDefaultStorage",()=>{var s;return(s=P)==null?void 0:s.localStorage})()}catch(s){f(s)}if(!t)return v;const p=j(r),N=me(p),m=(a=n.serializer)!=null?a:$e[N],{pause:T,resume:F}=ye(v,()=>M(v.value),{flush:o,deep:h,eventFilter:y});return l&&g&&(J(l,"storage",A),J(l,I,K)),A(),v;function M(s){try{if(s==null)t.removeItem(e);else{const i=m.write(s),d=t.getItem(e);d!==i&&(t.setItem(e,i),l&&l.dispatchEvent(new CustomEvent(I,{detail:{key:e,oldValue:d,newValue:i,storageArea:t}})))}}catch(i){f(i)}}function H(s){const i=s?s.newValue:t.getItem(e);if(i==null)return w&&p!==null&&t.setItem(e,m.write(p)),p;if(!s&&u){const d=m.read(i);return typeof u=="function"?u(d,p):N==="object"&&!Array.isArray(d)?x(x({},p),d):d}else return typeof i!="string"?i:m.read(i)}function K(s){A(s.detail)}function A(s){if(!(s&&s.storageArea!==t)){if(s&&s.key==null){v.value=p;return}if(!(s&&s.key!==e)){T();try{v.value=H(s)}catch(i){f(i)}finally{s?Z(F):F()}}}}}function V(e,r,t={}){const{window:n=P}=t;return Pe(e,r,n==null?void 0:n.localStorage,t)}const je=ee("user",{state:()=>({user:{},access_token:V("access_token",""),refresh_token:V("refresh_token",""),events:[{}],events_next:""}),getters:{isLoggedIn:e=>e.access_token.length>0},actions:{async registerUser(e,r,t){try{const n=await _.post("/register",{username:e,email:r,password:t});return O.create({message:"Registration is successfully complete.",icon:"check_circle",color:"green"}),n.data}catch(n){O.create({message:`Error: ${JSON.stringify(Object.values(n.response.data)[0][0])}`,icon:"error",color:"red"})}},async loginUser(e,r){try{const t=await _.post("/login/",{username:e,password:r});return O.create({message:"Logged in!",icon:"check_circle",color:"green"}),this.access_token=t.data.access,this.refresh_token=t.data.refresh,this.access_token}catch(t){O.create({message:`Error: ${JSON.stringify(t.response.data)}`,icon:"error",color:"red"});return}},async fetchCurrentUser(){const e={Authorization:`Bearer ${this.access_token}`};try{const r=await _.get("/user",{headers:e});return this.user=r.data,this.user}catch{return}},async fetchUserEvents(){const e={Authorization:`Bearer ${this.access_token}`};try{const r=await _.get("/user/events",{headers:e});return this.events_next=r.data.next,this.events=r.data.results,this.events}catch{return}},async createUserEvent(e){const r={Authorization:`Bearer ${this.access_token}`};try{return(await _.post("/user/events",e,{headers:r})).data}catch{return}},async deleteUserEvent(e){const r={Authorization:`Bearer ${this.access_token}`};try{const t=await _.delete(`/user/events/${e}`,{headers:r});this.fetchUserEvents()}catch{return}}}});export{je as u};
