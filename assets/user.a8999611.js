import{a4 as q,a5 as G,a6 as Q,C as L,a7 as X,w as U,a8 as Y,n as Z,a9 as ee,aa as O}from"./index.20ac43b0.js";import{api as w}from"./axios.6cf50c67.js";function re(e){return G()?(Q(e),!0):!1}function j(e){return typeof e=="function"?e():q(e)}const E=typeof window!="undefined",te=()=>{};function ne(e,r){function t(...n){return new Promise((s,o)=>{Promise.resolve(e(()=>r.apply(this,n),{fn:r,thisArg:this,args:n})).then(s).catch(o)})}return t}const W=e=>e();function ae(e=W){const r=L(!0);function t(){r.value=!1}function n(){r.value=!0}const s=(...o)=>{r.value&&e(...o)};return{isActive:X(r),pause:t,resume:n,eventFilter:s}}var D=Object.getOwnPropertySymbols,se=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable,ie=(e,r)=>{var t={};for(var n in e)se.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&D)for(var n of D(e))r.indexOf(n)<0&&oe.call(e,n)&&(t[n]=e[n]);return t};function ce(e,r,t={}){const n=t,{eventFilter:s=W}=n,o=ie(n,["eventFilter"]);return U(e,ne(s,r),o)}var le=Object.defineProperty,ue=Object.defineProperties,fe=Object.getOwnPropertyDescriptors,P=Object.getOwnPropertySymbols,R=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable,z=(e,r,t)=>r in e?le(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,pe=(e,r)=>{for(var t in r||(r={}))R.call(r,t)&&z(e,t,r[t]);if(P)for(var t of P(r))T.call(r,t)&&z(e,t,r[t]);return e},de=(e,r)=>ue(e,fe(r)),ye=(e,r)=>{var t={};for(var n in e)R.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&P)for(var n of P(e))r.indexOf(n)<0&&T.call(e,n)&&(t[n]=e[n]);return t};function ve(e,r,t={}){const n=t,{eventFilter:s}=n,o=ye(n,["eventFilter"]),{eventFilter:y,pause:_,resume:g,isActive:u}=ae(s);return{stop:ce(e,r,de(pe({},o),{eventFilter:y})),pause:_,resume:g,isActive:u}}function he(e){var r;const t=j(e);return(r=t==null?void 0:t.$el)!=null?r:t}const $=E?window:void 0;E&&window.document;E&&window.navigator;E&&window.location;function J(...e){let r,t,n,s;if(typeof e[0]=="string"||Array.isArray(e[0])?([t,n,s]=e,r=$):[r,t,n,s]=e,!r)return te;Array.isArray(t)||(t=[t]),Array.isArray(n)||(n=[n]);const o=[],y=()=>{o.forEach(c=>c()),o.length=0},_=(c,l,v,f)=>(c.addEventListener(l,v,f),()=>c.removeEventListener(l,v,f)),g=U(()=>[he(r),j(s)],([c,l])=>{y(),c&&o.push(...t.flatMap(v=>n.map(f=>_(c,v,f,l))))},{immediate:!0,flush:"post"}),u=()=>{g(),y()};return re(u),u}const S=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},b="__vueuse_ssr_handlers__",_e=ge();function ge(){return b in S||(S[b]=S[b]||{}),S[b]}function we(e,r){return _e[e]||r}function me(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}var Oe=Object.defineProperty,x=Object.getOwnPropertySymbols,Se=Object.prototype.hasOwnProperty,be=Object.prototype.propertyIsEnumerable,C=(e,r,t)=>r in e?Oe(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,I=(e,r)=>{for(var t in r||(r={}))Se.call(r,t)&&C(e,t,r[t]);if(x)for(var t of x(r))be.call(r,t)&&C(e,t,r[t]);return e};const Pe={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},V="vueuse-storage";function $e(e,r,t,n={}){var s;const{flush:o="pre",deep:y=!0,listenToStorageChanges:_=!0,writeDefaults:g=!0,mergeDefaults:u=!1,shallow:c,window:l=$,eventFilter:v,onError:f=a=>{console.error(a)}}=n,h=(c?Y:L)(r);if(!t)try{t=we("getDefaultStorage",()=>{var a;return(a=$)==null?void 0:a.localStorage})()}catch(a){f(a)}if(!t)return h;const p=j(r),N=me(p),m=(s=n.serializer)!=null?s:Pe[N],{pause:B,resume:F}=ve(h,()=>M(h.value),{flush:o,deep:y,eventFilter:v});return l&&_&&(J(l,"storage",A),J(l,V,K)),A(),h;function M(a){try{if(a==null)t.removeItem(e);else{const i=m.write(a),d=t.getItem(e);d!==i&&(t.setItem(e,i),l&&l.dispatchEvent(new CustomEvent(V,{detail:{key:e,oldValue:d,newValue:i,storageArea:t}})))}}catch(i){f(i)}}function H(a){const i=a?a.newValue:t.getItem(e);if(i==null)return g&&p!==null&&t.setItem(e,m.write(p)),p;if(!a&&u){const d=m.read(i);return typeof u=="function"?u(d,p):N==="object"&&!Array.isArray(d)?I(I({},p),d):d}else return typeof i!="string"?i:m.read(i)}function K(a){A(a.detail)}function A(a){if(!(a&&a.storageArea!==t)){if(a&&a.key==null){h.value=p;return}if(!(a&&a.key!==e)){B();try{h.value=H(a)}catch(i){f(i)}finally{a?Z(F):F()}}}}}function k(e,r,t={}){const{window:n=$}=t;return $e(e,r,n==null?void 0:n.localStorage,t)}const je=ee("user",{state:()=>({user:{},access_token:k("access_token",""),refresh_token:k("refresh_token",""),events:[{}],events_next:""}),getters:{isLoggedIn:e=>e.access_token.length>0},actions:{async registerUser(e,r,t){try{const n=await w.post("/register",{username:e,email:r,password:t});return O.create({message:"Registration is successfully complete.",icon:"check_circle",color:"green"}),n.data}catch(n){O.create({message:`Error: ${JSON.stringify(Object.values(n.response.data)[0][0])}`,icon:"error",color:"red"})}},async loginUser(e,r){try{const t=await w.post("/login/",{username:e,password:r});return O.create({message:"Logged in!",icon:"check_circle",color:"green"}),this.access_token=t.data.access,this.refresh_token=t.data.refresh,this.access_token}catch(t){O.create({message:`Error: ${JSON.stringify(t.response.data)}`,icon:"error",color:"red"});return}},async fetchCurrentUser(){const e={Authorization:`Bearer ${this.access_token}`};try{const r=await w.get("/user",{headers:e});return this.user=r.data,this.user}catch{return}},async fetchUserEvents(){const e={Authorization:`Bearer ${this.access_token}`};try{const r=await w.get("/user/events",{headers:e});return this.events_next=r.data.next,this.events=r.data.results,this.events}catch{return}},async createUserEvent(e){const r={Authorization:`Bearer ${this.access_token}`};try{return(await w.post("/user/events",e,{headers:r})).data}catch{return}}}});export{je as u};
